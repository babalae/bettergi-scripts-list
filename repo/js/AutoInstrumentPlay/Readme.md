# 【原琴】自动演奏
此脚本可接受以下类型的乐谱进行自动演奏
- 五线谱(TODO)
- 简谱
- 按键序列

以下将演示如何编写一个合法的乐谱  
``` Json
{
    "name": 乐谱名称，在左下角遮罩中打印,
    "type": 乐谱类型，决定了如何解析乐谱，合法的类型：keyboard(按键序列)，line(五线谱)，number(简谱),

    "instrument":可选，此项用于标识以何种乐器演奏音乐,
    "desc":可选，此项用于描述本乐谱的出处、原作者、编码作者，如果信息较多可使用desc加后缀模拟换行(,

    "key_signature":调号，用于计算按键序列，简谱必要的信息,
    "beats_per_measure": 每小节的拍数，简谱必要的信息,
    "beat_unit": 每拍的音符时值，简谱必要的信息,
    "BPM": 拍数每分钟，简谱必要的信息,

    "music_gap":按键间隔，单位为ms，按键序列必要的信息,

    "file":优先级高于sheet，脚本会格式化字符串：`assets/${file}`,
    "sheet":把你的乐谱放到此处，注意不要换行导致违反json语法
}
```
编写以上Json文件并保存至本目录的assets文件夹下后，在自定义配置的乐谱名称中将文件名(不需要json后缀)填入即可
## 接下来将解释如何合法的编写一份乐谱：
**注意：在独立文件中编写乐谱时，换行会被无视**  
**因此我更推荐使用file键值对声明乐谱以提高可读性**
### 五线谱(TODO)
### 简谱


### 按键序列
- 一个A-Z字母各自代表键盘上的按键，代表指定的按键被按下一个间隔的时长，其他按键将被抬起
- '-'(减号)增时线，左侧最近一组按钮多维持一个间隔
- ' '(空格)和'0'代表休止符
- '/'(撇斜杠)用于分隔小节
- 使用()小括号或{}大括号包括的字母将视为同一组按钮，它们会被同时按下，比如(QG)-SJ和{QG}-SJ，Q和G会被同时按下并维持一个间隔的时长
- ()和{}两种括号的区别是如果括号包裹的一组按键与其左侧一组(同小节)按键保持按下或连续按下，比如 Q(QE){E}，Q会按下两个间隔的时长，但是E会按下两次，每次一个间隔
- 使用[]包裹的一组会根据[]中的按键加权平均此组按键的时长，比如[QWE]中Q、W、E会各自维持1/3个间隔的时长，[QWEE]中Q、W维持1/4个间隔的时长，E维持1/2间隔的时长,你可以使用[Q000]在支持长按的乐器（比如晚风圆号和越律琴）中实现点按的效果，而不支持长按的乐器（比如诗琴）就算长按的效果也和短按是一样的
- 三种括号不能混用、嵌套
- 增时线对()、[]、{}包裹的字母也能生效
- 如果需要在两个小节间维持按键按下，使用'>'(大于号),比如(QG)-SJ>(JG)Q(WJ)G，J会维持两个间隔的时长，否则(QG)-SJ/(JG)Q(WJ)G时J仍然会按下两次，每次一个间隔时长
- 按键序列可用的合法字符：A-Z '-' '>' '(' ')' '[' ']' '{' '}' '0' ' ':(空格)

## 解析流程
### 按键序列
1. 字符串