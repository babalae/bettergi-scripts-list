# 使用前准备

**双击运行脚本所在目录下的`SymLink.bat`文件，以创建符号链接。**

此操作只需要一次。运行后，脚本下的`pathing`文件夹将指向Better GI的地图追踪文件夹`User\AutoPathing`，你通过Better GI新增或删除地图追踪任务后，脚本这边看到的也是修改后的。

# 运行模式

必须先完成`使用前准备`里的操作

## 1. 扫描文件夹更新可选材料列表

扫描脚本`pathing`目录（等价于你在Better GI里订阅的地图追踪任务目录）下的`地方特产`、`矿物`、`食材与炼金`内的材料，并自动匹配材料的刷新时间。

扫描完成后，将自动更新脚本可用的配置菜单。此时再次打开右键的`修改JS脚本自定义配置`，将看到新增了多个配置项，其中包含刚刚扫描到的材料目录。


<!-- ![preview.png](https://github.com/user-attachments/assets/62961d83-cde4-4de6-9b87-bdaaf63896db) -->
![preview.png](https://foruda.gitee.com/images/1749967868807757262/ada1abf2_9716310.png)

如果你订阅了很多地图追踪任务，那么扫描结果也会比较多，选项列表也会比较长，但不影响脚本运行。

只有你新增或者删除了地图追踪任务的订阅时，才需要运行此模式。

## 2. 采集选中的材料

此模式下有这些选项可以配置：

| 选项 | 说明 |
| ---- | ---- |
| `地图追踪`中已订阅的任务目录的处理方式 | 有三种处理方式：<br>- `每次自动扫描，并采集扫描到的所有材料`<br>- `手动扫描，并采集扫描到的所有材料`<br>- `手动扫描，只采集已勾选的材料`<br>`自动扫描`会在每次执行采集前扫描当前已订阅的任务目录，`手动扫描`则是手动将运行模式切换到扫描模式执行脚本进行扫描。<br>`采集所有`会无视后面的每个材料⬇️是否选中，`采集已勾选`则是根据勾选的列表进行采集 |
| 设置首选队伍名称 | 执行采集任务前切换到指定的队伍，未设置则不切换。 |
| 设置备选队伍名称 | 首选队伍缺少对应的采集角色时使用。<br>两支队伍的名称不要存在包含关系，例如不能一支叫`特产`一支叫`特产备选` |
| 停止运行时间 | 超过此时间后，停止后续的任务（会等待正在运行的那条json路线结束）。 |
| 我肝的账号不止一个 | 如果你有多个账号，可以选中此选项，选中后将分账号维护对应的材料刷新时间。 |
| 即使同一种材料有多个版本的路线，也全都执行采集 | 如果某种材料选中了多个版本的路线（常见于不同作者），默认只会执行第一个。勾选此选项后会每个版本都执行，可能造成部分点位重复（空跑）。 |
| `↓` 地方特产\稻妻\绯樱绣球 | 根据你订阅的路径追踪任务数量，这里将会显示相应个数的选择框。<br>勾选后将执行你选中的条目的采集任务。<br>Tip: `↓`符号是在提示你应该勾选文本下面的选择框 |

**推荐的配置**: 运行模式设置为`采集选中的材料`，已订阅的任务目录的处理方式设置为`每次自动扫描，并采集扫描到的所有材料`。这样一来，待采集的材料列表自动保持与你订阅的列表一致，新增/删除材料也直接通过BetterGI的界面执行，每次直接运行脚本即可。

运行此模式后，将按照你勾选的条目，执行相应的采集任务。每执行完一条json路线后，将会计算它的下次刷新时间并写入`record`文件夹下的记录文件。下次运行脚本时，未刷新的路线将自动跳过。

可以同时勾选多种材料，会逐个进行采集。

采集任务可能用到的元素共有`火水雷风`4种，此外还有挖矿类（如钟离）以及纳西妲两个类型，可以考虑建立两支队伍`钟纳水雷`和`钟纳火风`，即可满足所有采集任务的需要。

支持使用配置组`更多功能`——`日志分析`分析运行记录（参考了[mno](https://github.com/Bedrockx)大佬的写法）。

<!-- ![log_analysis.png](https://github.com/user-attachments/assets/9496d191-b46a-4705-b5b9-4e00fa7ef2a5) -->
![log_analysis.png](https://foruda.gitee.com/images/1749967993135535153/3bbeecd3_9716310.png)

## 3. 清除运行记录（重置材料刷新时间）

此模式下，相关的选项只有`我肝的账号不止一个`和以`↓`开头的任务名，作用同上文。

运行此模式后，将重置你选中的任务相应材料的刷新时间。

如果你需要删除全部运行记录，可以直接删除脚本`record`文件夹下，以账号为名称的文件夹内的文件。
