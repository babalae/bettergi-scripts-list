# 使用前准备

**双击运行脚本所在目录下的`SymLink.bat`文件，以创建符号链接。**

此操作只需要一次。运行后，脚本下的`pathing`文件夹将指向Better GI的地图追踪文件夹`User\AutoPathing`，你通过Better GI新增或删除地图追踪任务后，脚本这边看到的也是修改后的。

# 运行模式

必须先完成`使用前准备`里的操作

## 1. 扫描文件夹更新可选材料列表

扫描脚本`pathing`目录（等价于你在Better GI里订阅的地图追踪任务目录）下的`地方特产`、`矿物`、`食材与炼金`内的材料，并自动匹配材料的刷新时间。

扫描完成后，将自动更新脚本可用的配置菜单。此时再次打开右键的`修改JS脚本自定义配置`，将看到新增了多个配置项，其中包含刚刚扫描到的材料目录。

![preview.png](https://github.com/user-attachments/assets/62961d83-cde4-4de6-9b87-bdaaf63896db)

如果你订阅了很多地图追踪任务，那么扫描结果也会比较多，选项列表也会比较长，但不影响脚本运行。

只有你新增或者删除了地图追踪任务的订阅时，才需要运行此模式。

## 2. 采集选中的材料

此模式下有这些选项可以配置：

| 选项 | 说明 |
| ---- | ---- |
| 设置要使用的队伍名称 | 执行采集任务前切换到指定的队伍，未设置则不切换。 |
| 停止运行时间 | 超过此时间后，停止后续的任务（会等待已经运行中的json路线结束）。 |
| 我肝的账号不止一个 | 如果你有多个账号，可以选中此选项，选中后将分账号维护对应的材料刷新时间。 |
| `↓` 地方特产\稻妻\绯樱绣球 | 根据你订阅的路径追踪任务数量，这里将会显示相应个数的选择框。<br>勾选后将执行你选中的条目的采集任务。<br>Tip: `↓`符号是在提示你应该勾选文本下面的选择框 |

运行此模式后，将按照你勾选的条目，执行相应的采集任务。每执行完一条json路线后，将会计算它的下次刷新时间并写入`record`文件夹下的记录文件。下次运行脚本时，未刷新的路线将自动跳过。

可以同时勾选多种材料，会逐个进行采集。

如果不同的采集任务需要不同队伍，那请在调度器配置组里添加多次本脚本，然后分别设置不同的采集物和采集队伍。

支持使用配置组`更多功能`——`日志分析`分析运行记录（参考了[mno](https://github.com/Bedrockx)大佬的写法）。

![log_analysis.png](https://github.com/user-attachments/assets/9496d191-b46a-4705-b5b9-4e00fa7ef2a5)

## 3. 清除运行记录（重置材料刷新时间）

此模式下，相关的选项只有`我肝的账号不止一个`和以`↓`开头的任务名，作用同上文。

运行此模式后，将重置你选中的任务相应材料的刷新时间。

如果你需要删除全部运行记录，可以直接删除脚本`record`文件夹下，以账号为名称的文件夹内的文件。
