# 背包材料统计 v2.5

## 简介：
可统计背包养成道具、部分食物、素材的数量；根据设定数量、根据材料刷新CD执行挖矿、采集、刷怪等的路径。优势：
+ 1. 自动判断材料CD，不需要管材料CD有没有好；
+ 2. 可以随意添加路径，能自动排除低效、无效路径；
+ 3. 有独立名单识别，不会交互路边的npc或是神像；可自定义识别名单，具体方法看【问题解答】增减识别名单
+ 4. 有实时的弹窗模块，提供了常见的几种:路边信件、过期物品、月卡、调查

## 用前须知：要有一点的动手能力！该JS不提供路径文件，需要文件夹操作

## 使用方法

## 基础教程
+ 1. 仓库 订阅 所需路径文件；
+ 2. 打开路径所在文件夹BetterGI\Repos\bettergi-scripts-list-git\repo\pathing；
  把地方特产、敌人与魔物、矿物、食材与炼金四个文件夹复制到背包材料统计JS目录BetterGI\User\JsScript\背包材料统计\pathing中；最好手动去除重复多余路径；pathing下只能读取3层文件夹，如pathing文件夹下有4层或以上子文件夹，请削减到3层；
+ 3. 推荐根据队伍来把路径分组放置。比如
   背包统计采集组，生存队：迪希雅 芭芭拉 瑶瑶 草神。适合一般情况下的采集；
   背包统计刷怪组，适合挂机输出的队：火神 奶奶 钟离 万叶，能够胜任需要刷怪的路径；
   背包统计附魔材料组，附魔队：钟离 芭芭拉 久岐忍 砂糖或班尼特，适合附魔采集；
+ 4. 找到背包材料统计js，右键 背包材料统计，选择JS修改脚本自定义设置；
 
## JS的自定义设置
+ 1. 目标数量，是扫描背包中材料数量，只有低于目标的材料，其路径才会被纳入执行序列；
+ 2. 优先级材料，是最高优先级，直接无视上述目标数量，纳入执行序列最顶层； 
+ 3. 时间成本，在一个路径存在3到5次记录时，会计算时间成本，单个材料获取时间超过默认30秒的，则跳过；
+ 4. 发送通知，每类材料跑完会通知一次，全部材料跑完会汇总通知一次。需在BGI通知里开启，接收端企业微信的使用自行寻找；
+ 5. 取消扫描，是取消每个路径执行完的扫描；当大部分需要的路径都有足够多记录，就可以不需要新增运行记录，可以不扫描了，以节约时间；但全部材料执行始末会各扫一次，以汇总材料信息。
+ 6. 仅pathing材料，是平衡背包材料统计和路径CD管理的选项；选择仅pathing材料，则直接无视下方勾选的材料分类，只扫描pathing文件夹已有的路径材料，没有的就不扫，以缩短扫描时间；
+ 7. 弹窗名，不填默认assets\imageClick文件夹下所有弹窗循环执行；弹窗模块会在背包统计运行时全程保护路径，防止弹窗影响路径执行；
+ 8. 采用的CD分类，不在materialsCD文件夹的不执行，这个文件夹可以按格式新增材料CD分类txt，只要背包材料统计的图库里有，路径所在的文件夹名正确，就能按CD执行；
+ 9. targetText文件夹里的是独立名单识别的名单，可以按随意新增txt，内容按格式，英文冒号前的名字也随便写；冒号后的文字会被当成目标来识别，不在targetText文件夹下不识别；

## 注意事项
+ 1. 联机请求会遮挡背包菜单导致识别不到类别，建议在背包统计JS前加一个权限设置JS，以禁止联机；
+ 2. pathing下只能读取3层文件夹，如pathing文件夹下有4层或以上的子文件夹，请削减到3层；
+ 3. 推荐根据功能需求来把路径分组放置。复制多份背包材料统计，分别加上采集、刷怪、附魔材料后缀，用于管理一般情况下的采集路径、能够胜任需要战斗的路径、需求附魔采集的路径；
+ 4. 因食物部分图片未补足，为适配快速滑页，背包食物界面，苹果、日落果、星蕈、活化的星蕈、枯焦的星蕈、泡泡桔、烛伞蘑菇、美味的宝石闪闪，这八个食物必须有，且在第一行。不然这几个食物会无法识别；

## 问题解答
+ 1. 如果不想要某些路径怎么排除？直接进pathing文件夹，把该材料名或者该怪物名路径文件夹移走或者删除；切记不要把路径文件放入targetText和materialsCD这两个文件夹；
+ 2. 如果想要增减识别名单怎么做？直接进targetText文件夹，选择或者新建一份txt，名字随意，内容按格式，英文冒号前的名字可随便写；冒号后的文字会被当成目标来识别，用英文逗号分割；如果想刷某类怪，但不想要拾取其怪物材料，可以找到掉落.txt，删除不要的材料名；
+ 3. 如果想要识别不规范命名的路径文件夹怎么做？比如纳塔食材一条龙或者果园.json。方法：把纳塔食材一条龙文件夹或者果园.json丢进一个适配的材料文件夹里，CD要符合，因为CD选择是由所在的材料名文件夹决定；果园.json可以丢到苹果文件夹里；
+ 4. 如果想要识别自带CD文件中，没有的材料怎么做？比如新材料新木头；打开materialsCD文件夹，选择或者新建一份txt，名字随意，内容按格式，中文冒号前的名字也要按格式，具体参考自带的CD文件，如几点，几小时，几次0点；冒号后的文字会被当成目标来识别，用中文逗号分割；注意这个文字就是作为JS里的标准名，路径所在文件夹名和材料图片名都必须和它一致；多层套叠的文件夹会默认选择符合标准名的那个，如有同名套叠会选最外层那个；
+ 5. 如果不想要每次路径都扫描背包怎么做？具体方法看【JS的自定义设置】取消扫描；

## 后言
本脚本目前处于测试阶段，欢迎反馈问题至 QQ频道号: bettergiv1。

## 更新日志
+ v0.1 OCR名单 输出图片名和材料名
+ v1.0 图包(素材)
+ v1.1 图包(素材+养成道具)
+ v1.2 识图分类
+ v1.3 加速寻找(前位材料识别)
+ v1.31 本地保存调整
+ v1.32 新增后位材料识别
+ v2.0 多组材料多个分类 开发版 
- v2.0 前、后位材料识别
+ v2.1 CD管理版
+ v2.2 路径顺序 材料数量优化
+ v2.21 储存路径修改
+ v2.22 精简log
+ v2.23 优化部分函数
+ v2.24 修复不能空路径使用背包统计功能等bug
+ v2.25 当前、后位材料识别（加速扫描），新增只扫描路径材料名选项（内存占用更小）
+ v2.26 修复读取材料时间错误等bug，新增路径材料时间成本计算
+ v2.27 修复计算材料数错误、目标数量临界值、"3"识别成"三"等bug
+ v2.28 材料更变时初始数量更新；正常记录排除0位移和0数量的路径记录(可能是卡路径，需手动根据0记录去甄别)，新增材料名0后缀本地记录；新增背包弹窗识别
+ v2.29 新增排除提示；调整平均时间成本计算；过滤掉差异较大的记录；
+ v2.30 更改路径专注模式默认值，加log提示；去除注释掉的调试log；
+ v2.40 优化背包识别时占用的内存;增加通知；
+ v2.41 修复勾选分类的本地记录bug，新增仅背包统计选项；如果本地记录已经遭到破坏。比如每条路径都产生大量材料名-0.txt，就只能手动清理或者删除本地记录pathing_record，重新跑；
+ v2.42 增加无路径间的扫描、无数量记录的noRecord模式，适合路径记录已经炼成的玩家。新增怪物材料CD文件，以支持轻度刷怪需求。
+ v2.5 增加独立名单拾取，增加弹窗模块，这个2个是背包材料统计JS运行时实时运行。增加对怪物名的支持。
