// ==UserScript==
// @name         背包统计采集系统
// @version      2.40
// @description  识别路径文件，根据材料数量，自动执行路线，或者主动选择材料类别，统计材料数量
// @author       吉吉喵
// @match        原神版本：5.6；BGI 版本：0.44.8
// ==/UserScript==

/**
 * === 重要免责声明 ===
 * 1. 使用风险
 *    - 本脚本为开源学习项目，禁止用于商业用途或违反游戏条款的行为。
 *    - 滥用可能导致游戏账号封禁，开发者不承担任何直接或间接责任。
 *
 * 2. 责任限制
 *    - 本脚本按“现状”提供，不承诺兼容性、安全性或功能完整性。
 *    - 因使用本脚本导致的账号、数据、设备损失，开发者概不负责。
 *
 * 3. 禁止条款
 *    - 严禁逆向工程、恶意篡改或用于外挂等非法用途。
 *    - 如游戏运营商提出要求，开发者保留随时停止维护的权利。
 *
 * 使用即表示您已阅读并同意上述条款。
 *
 * Last Updated: 2025-05-19
 */
# 背包材料统计

## 简介：
背包材料统计，可统计背包养成道具、部分食物、素材的数量，并保存本地；还可根据设定数量，自动根据CD执行采集路径。

## 文件结构

./📁BetterGI/📁User/📁JsScript/
📁背包材料统计/
    📁pathing/
        📁 薄荷/
            📄 薄荷1.json
            📁 薄荷效率/
                📄 薄荷-吉吉喵.json
        📁 苹果/
            📄 旅行者的果园.json
    📁history_record/ 背包统计 自动生成，每类的历史记录（每类中旧纪录上限为365个）
    📁overwrite_record/ 背包统计 自动生成，每类的最新一次记录
    📁pathing_record/ 自动生成，路径运行时间记录
    📁materialsCD/ 路径CD管理 自带的CD文件
    📄 latest_record.txt 背包统计 自动生成，最新一次统计
    📁assets 图包

## 使用方法
1. 将脚本添加至调度器。
2. 右键点击脚本以修改JS自定义配置。
3. 执行路径功能，需要📁pathing有路径文件夹

## 注意
因食物部分图片未补足，为适配快速滑页，苹果、日落果、星蕈、活化的星蕈、枯焦的星蕈、泡泡桔、烛伞蘑菇、美味的宝石闪闪，这八个食物必须有，且在第一行。不然这几个食物会无法识别。

## 后言
本脚本目前处于测试阶段，欢迎反馈问题至 QQ频道号: bettergiv1。

## 更新日志
+ v0.1 OCR名单 输出图片名和材料名
+ v1.0 图包(素材)
+ v1.1 图包(素材+养成道具)
+ v1.2 识图分类
+ v1.3 加速寻找(前位材料识别)
+ v1.31本地保存调整
+ v1.32 新增后位材料识别
+ v2.0 多组材料多个分类 开发版 
- v2.0 前、后位材料识别
+ v2.1 CD管理版
+ v2.2 路径顺序 材料数量优化
+ v2.21 储存路径修改
+ v2.22 精简log
+ v2.23 优化部分函数
+ v2.24 修复不能空路径使用背包统计功能等bug
+ v2.25 当前、后位材料识别（加速扫描），新增只扫描路径材料名选项（内存占用更小）
+ v2.26 修复读取材料时间错误等bug，新增路径材料时间成本计算
+ v2.27 修复计算材料数错误、目标数量临界值、"3"识别成"三"等bug
+ v2.28 材料更变时初始数量更新；正常记录排除0位移和0数量的路径记录(可能是卡路径，需手动根据0记录去甄别)，新增材料名0后缀本地记录；新增背包弹窗识别
+ v2.29 新增排除提示；调整平均时间成本计算；过滤掉差异较大的记录；
+ v2.30 更改路径专注模式默认值，加log提示；去除注释掉的调试log；背包材料统计更改名为背包统计采集系统
+ v2.40 优化背包识别时占用的内存;增加通知；
+ v2.41 修复勾选分类的本地记录bug，新增仅背包统计选项；如果本地记录已经遭到破坏。比如每条路径都产生大量材料名-0.txt，就只能手动清理或者删除本地记录pathing_record，重新跑