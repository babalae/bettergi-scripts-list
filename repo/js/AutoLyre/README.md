# 曲谱 JSON 文件说明
此文档供曲谱制作人阅读，本文档详细说明了如何书写一个标准格式的曲谱.json文件，包括各个字段的解释以及曲谱内容的格式要求。
重要：即使制作了曲谱的JSON文件，放到了正确的路径下，在调度器的JS脚本配置里也不会出现你制作的曲谱（上传方法如下）

## 上传方法
1.上传到BetterGI脚本仓库的repo\js\AutoLyre\assets路径下，根据已存在的曲谱在你的文件名前添加序号(例如 10.曲名.json)，完成后请联系BetterGI v7群主更新JS脚本
2.联系BetterGI v7（1029539994）群主帮你更新到仓库
3.发送邮件到hijiwos@hotmail.com并说明，你的谱子将会在一段时间内更新到仓库

## 文件位置
所有的曲谱文件应放置于 AutoLyre\assets 目录下，并在文件名前添加正确的序号

## 文件结构
一个标准的曲谱.json文件的基本结构如下：

{
  "name": "",
  "author": "",
  "bpm": "",
  "time_signature": "",
  "composer": "",
  "arranger": "",
  "notes": ""
}

注意：仅: 右侧的双引号内的部分可以更改，具体的曲谱格式请参考assets文件夹下的example.json
## 字段说明
name: 曲谱名，必填。

author: 录谱人，制作这个.json曲谱的作者名。

bpm: 曲谱的BPM（Beats Per Minute），必填。

time_signature: 拍号，必填，例如 3/4 代表 以四分音符为一拍每小节三拍（被设为一拍的音符仅支持2的幂）。

composer: 曲师，选填。

arranger: 谱师，选填。

notes: 曲谱内容，必填，具体格式请参考以下解析规则。

## Notes 解析规则（重要）
notes 字段中包含的是乐谱内容。乐谱内容使用字符串表示，小节之间用 | 隔开。单个小节的解析规则如下：

A[4]: 表示按下A键，A键视作四分音符。

(ASD)[4-#]: 表示同时按下ASD键，这个和弦视作四分音符的装饰音。

A[4-3](AS)[4-3](ASD)[4-3]: 表示等分四分音符的三连音（- 后填 3 必须要连着写三个这样的音符），按顺序按下A、AS、ASD键。

@[4]: 表示休止符，中括号内标明这是几分休止符，例如这里表示四分休止符。

A[4-*]: 表示按下A键，A键视作附点四分音符。

## 代码美化
曲谱JSON文件的"notes"的值视作一个字符串，在这个字符串内可以使用空格和换行符美化代码（notes内的空格和换行符不会被读取执行）

例如: 
{
  "name": "示例曲谱",
  "author": "录谱人A",
  "bpm": "120",
  "time_signature": "4/4",
  "composer": "曲师B",
  "arranger": "谱师C",
  "notes": "A[4](ASD)[8]Y[8-#]F[8-#](DFG)[8]R[4-*]T[8]|
            @[4](DFG)[8-3](CVB)[8]D[4]A[4]|
			A[4](ASD)[8]Y[8-#]F[8-#](DFG)[8]R[4]T[4]|
            @[4](DFG)[8-3](CVB)[8]D[4]A[4]|"
}

## 附：
中括号 []（- 前表示音符类型，- 后用于区分特殊音符）

[4] 表示四分音符。

[16] 表示十六分音符。

[-#] 表示装饰音。

[-3] 表示三连音（使用时必须保证是三个连续的三连音）。

例如：[16-#] 表示十六分音符的装饰音，A[4-3]S[4-3]D[4-3] 表示一个时值为4分音符的三连音。

## 示例
一个完整的曲谱.json文件示例如下（仅包含两个小节）：

文件名: 示例曲谱.json

{
  "name": "示例曲谱",
  "author": "录谱人A",
  "bpm": "120",
  "time_signature": "4/4",
  "composer": "曲师B",
  "arranger": "谱师C",
  "notes": "A[4](ASD)[8]Y[8-#]F[8-#](DFG)[8]R[4-*]T[8]|@[4](DFG)[8-3](CVB)[8]D[4]A[4]"
}